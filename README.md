# Домашнее задание к занятию "`Название занятия`" - `Фамилия и имя студента`



---

### Задание 1

`Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования.`

1. `Необходимо восстанавливать данные в полном объёме за предыдущий день.`
```
Для таких целей подойдет полное резервное копирование (Full Backup) ежедневно.
- Преимущества: Простота восстановления. Легко реализовать.
- Недостатки: Самое долгое время резервного копирования. Требует больше места для хранения.

```
2. `Восстановление данных за час до предполагаемой поломки`
```
Комбинация полного, инкрементного или дифференциального резервного копирования .
- Полное резервное копирование (Full Backup): Как в п. 1.1, выполняется регулярно.
- Дифференциальное резервное копирование (Differential Backup): Ежедневно, но копируются только изменения с момента последнего полного резервного копирования. Это быстрее, чем полное, но медленнее, чем инкрементное.
- Инкрементное резервное копирование (Incremental Backup): Ежедневно, но копируются только изменения с момента последнего любого (полного или инкрементного) резервного копирования. Самое быстрое резервное копирование, но самое сложное и долгое восстановление, так как для восстановления нужно последовательно применить все инкрементные копии с момента последнего полного резервного копирования.
 
```
3. `Моментальное переключение на работающую или починенную базу данных`

```
Использование кластеризации баз данных, репликации и/или технологии Always On Availability Groups (в случае использования MS SQL Server).
- Кластеризация баз данных (Database Clustering): Несколько серверов баз данных работают вместе как единая система. В случае сбоя одного сервера, другой сервер автоматически берет на себя его роль.
- Репликация (Replication): Данные с основной базы данных (primary) постоянно реплицируются (копируются) на резервную базу данных (replica). В случае сбоя основной базы данных, резервная база данных автоматически становится основной. Существуют различные типы репликации: синхронная (данные записываются одновременно на обе базы, обеспечивает минимальную потерю данных, но может замедлять работу) и асинхронная (данные сначала записываются на основную
базу, а потом реплицируются, более быстрая, но возможна потеря данных).
- Always On Availability Groups (MS SQL Server): Аналогично репликации, но предоставляет более гибкие настройки и возможности для переключения между базами данных.
```
---

### Задание 2

`PostgreSQL`

1. `С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).`
```
pg_dump -U <имя_пользователя> -h <имя_хоста> -p <порт> -F p -f <имя_файла_резервной_копии.sql> <имя_базы_данных>

*   -U <имя_пользователя>: Имя пользователя PostgreSQL, под которым будет выполняться операция. Часто это postgres.
•   -h <имя_хоста>: Имя хоста, где находится сервер PostgreSQL.  Используйте localhost или 127.0.0.1 для локального сервера.
•   -p <порт>: Номер порта PostgreSQL. По умолчанию 5432.
•   -F p:  Указывает формат вывода. p означает plain text (обычный SQL-скрипт).  Другие варианты включают c (custom format), d (directory format), t (tar format). Формат c предпочтительнее для больших баз данных, т.к. поддерживает сжатие и параллельное восстановление.
•   -f <имя_файла_резервной_копии.sql>: Имя файла, в который будет записана резервная копия.
•   <имя_базы_данных>: Имя базы данных, которую нужно скопировать.

Пример:
pg_dump -U postgres -h localhost -p 5432 -F p -f my_database_backup.sql my_database

Эта команда создаст файл my_database_backup.sql с SQL-инструкциями, необходимыми для восстановления базы данных my_database.

Восстановление (pg_restore):
psql -U <имя_пользователя> -h <имя_хоста> -p <порт> -d <имя_базы_данных> -f <имя_файла_резервной_копии.sql>
*   -U <имя_пользователя>: Имя пользователя PostgreSQL.
•   -h <имя_хоста>: Имя хоста.
•   -p <порт>: Номер порта.
•   -d <имя_базы_данных>: Имя базы данных, в которую нужно восстановить данные.  База данных должна существовать!
•   -f <имя_файла_резервной_копии.sql>: Имя файла резервной копии.

Пример:
psql -U postgres -h localhost -p 5432 -d my_database -f my_database_backup.sql
```
2. `Возможно ли автоматизировать этот процесс? Если да, то как?`
```
Да, процесс резервного копирования можно автоматизировать.  Есть несколько способов:

1.  Cron:  Cron - это планировщик задач, доступный в большинстве Unix-подобных операционных систем. Может использовать cron для запуска команд pg_dump через определенные промежутки времени (например, каждый день в 2 часа ночи).

    Пример записи в crontab (отредактируйте с помощью команды crontab -e):
 0 2   * pg_dump -U postgres -h localhost -p 5432 -F c -f /path/to/backups/my_database_$(date +\%Y-\%m-\%d).dump my_database
Эта запись будет запускать pg_dump каждый день в 2:00 ночи и сохранять резервную копию в файл с именем my_database_<дата>.dump в каталоге /path/to/backups/. Обратите внимание на экранирование символа % в date +\%Y-\%m-\%d.
2 . Скрипты Shell:  Можем создать скрипт shell, который выполняет резервное копирование и, например, ротацию старых резервных копий.  Затем этот скрипт можно запустить через cron.  Это обеспечивает большую гибкость и контроль над процессом.

```

---

### Задание 3

`Приведите ответ в свободной форме........`

1. `Заполните здесь этапы выполнения, если требуется ....`
2. `Заполните здесь этапы выполнения, если требуется ....`
3. `Заполните здесь этапы выполнения, если требуется ....`
4. `Заполните здесь этапы выполнения, если требуется ....`
5. `Заполните здесь этапы выполнения, если требуется ....`
6. 

```
Поле для вставки кода...
....
....
....
....
```

`При необходимости прикрепитe сюда скриншоты
![Название скриншота](ссылка на скриншот)`

### Задание 4

`Приведите ответ в свободной форме........`

1. `Заполните здесь этапы выполнения, если требуется ....`
2. `Заполните здесь этапы выполнения, если требуется ....`
3. `Заполните здесь этапы выполнения, если требуется ....`
4. `Заполните здесь этапы выполнения, если требуется ....`
5. `Заполните здесь этапы выполнения, если требуется ....`
6. 

```
Поле для вставки кода...
....
....
....
....
```

`При необходимости прикрепитe сюда скриншоты
![Название скриншота](ссылка на скриншот)`
